<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Welcome</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            overflow: hidden;
            color: #ff6600;
        }
        .container {
            text-align: center;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }
        h1 {
            font-size: 5rem;
            margin: 0;
            text-shadow: 0 0 10px #ff6600, 0 0 20px #ff6600, 0 0 30px #ff6600;
            animation: flicker 2s infinite alternate;
        }
        @keyframes flicker {
            0%, 18%, 22%, 25%, 53%, 57%, 100% {
                text-shadow: 0 0 10px #ff6600, 0 0 20px #ff6600, 0 0 30px #ff6600;
            }
            20%, 24%, 55% {
                text-shadow: none;
            }
        }
        .moon {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 100px;
            height: 100px;
            background-color: #f1c40f;
            border-radius: 50%;
            box-shadow: 0 0 20px #f1c40f;
        }
        .ghost {
            font-size: 4rem;
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        .spider-web {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle, transparent 20%, #000 20%, #000 80%, transparent 80%, transparent),
                radial-gradient(circle, transparent 20%, #000 20%, #000 80%, transparent 80%, transparent) 50px 50px,
                linear-gradient(#222 8px, transparent 8px) 0 -4px,
                linear-gradient(90deg, #222 8px, transparent 8px) -4px 0;
            background-size: 100px 100px, 100px 100px, 50px 50px, 50px 50px;
            opacity: 0.1;
            z-index: -1;
        }
        .bats {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .bat {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #000;
            transform: skew(10deg);
            animation: fly 10s infinite linear;
        }
        .bat::before,
        .bat::after {
            content: '';
            position: absolute;
            background: #000;
            width: 15px;
            height: 10px;
            border-radius: 50% 50% 0 0;
            top: -5px;
        }
        .bat::before { left: -8px; transform: rotate(-30deg); }
        .bat::after { right: -8px; transform: rotate(30deg); }
        @keyframes fly {
            0% { transform: translate(0, 0) skew(10deg); }
            100% { transform: translate(100vw, -100vh) skew(10deg); }
        }
        .logout-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            font-size: 1rem;
            background-color: #ff6600;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .logout-button:hover {
            background-color: #cc5200;
        }
    </style>
</head>
<body>
    <div class="spider-web"></div>
    <div class="moon"></div>
    <div class="container">
        <h1>Welcome</h1>
        <div class="ghost">ðŸ‘»</div>
    </div>
    <div class="bats">
        <div class="bat" style="top: 10%; left: 5%; animation-delay: 0s;"></div>
        <div class="bat" style="top: 20%; left: 80%; animation-delay: 2s;"></div>
        <div class="bat" style="top: 50%; left: 50%; animation-delay: 4s;"></div>
        <div class="bat" style="top: 70%; left: 30%; animation-delay: 6s;"></div>
        <div class="bat" style="top: 80%; left: 70%; animation-delay: 8s;"></div>
    </div>

    <div class="sidebar-welcome">
        <h2>Hello, <span id="userEmail">[User's Email]</span>!</h2>
        </div>
    <li><a href="#" id="logoutLink" title="Logout"><span
        class="logout-button">logout</span></a></li>
</body>
<script>
    document.getElementById('logoutLink').addEventListener('click', function (event) {
        event.preventDefault();
        performLogout();
    });

    async function performLogout() {
        try {
            const response = await fetch('/logout', {
                method: 'POST',
                credentials: 'include'
            });
            if (response.ok) {
                // Redirect to login page
                window.location.href = 'index.html';
            } else {
                console.error('Logout failed');
            }
        } catch (error) {
            console.error('Error during logout:', error);
        }
    }

    // Fetch user details when the page loads
    document.addEventListener('DOMContentLoaded', function () {
        fetchUserDetails();
    });

    async function fetchUserDetails() {
        try {
            const response = await fetch('/user-details', { credentials: 'include' });
            if (!response.ok) {
                throw new Error('Failed to fetch user details.');
            }
                const data = await response.json();
            if (data.success) {
            // Update the element with user email
            document.getElementById('userEmail').textContent = data.user.email;
            } else {
            console.error('Failed to fetch user details:', data.message);
            }
        } catch (error) {
            console.error('Error fetching user details:', error);
        }
    }
</script>
</html>